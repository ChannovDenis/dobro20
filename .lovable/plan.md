

# Создание PRODUCT_SCOPE.md — полный аудит приложения

## Что будет сделано

Создание файла `PRODUCT_SCOPE.md` в корне проекта с полным описанием текущего состояния приложения "Добросервис".

## Содержание документа

Документ будет содержать 8 разделов на основе проведённого анализа:

### 1. Общее описание
- "Добросервис" — мобильное супер-приложение (B2B2C/B2B2E) для доступа к AI-ассистентам и живым экспертам по 12 направлениям (юрист, врач, психолог, стилист, садовод и др.)
- White-label платформа с мульти-тенантной архитектурой (Добросервис, Газпромбанк, Wildberries)
- Роли: конечный пользователь, партнёр-администратор, супер-администратор
- Бизнес-модель: подписка "Премиум" (заглушка, не реализована)

### 2. Карта экранов (13 экранов)
Для каждого экрана: описание UI, кликабельных элементов, источника данных и состояний:

| Экран | Роут | Данные |
|-------|------|--------|
| Splash | `/splash` | Статика |
| Feed (TikTok-лента) | `/feed` | Моки (15 карточек) |
| Chat | `/chat` | База данных (topics, topic_messages) |
| Services (Хаб сервисов) | `/services` | Моки (services, promotions) |
| Settings | `/settings` | Моки + Auth |
| Auth (Вход/Регистрация) | `/auth` | База данных (auth) |
| ServiceDetail | `/service/:id` | Моки (experts) |
| ExpertDetail | `/service/:id/expert/:expertId` | Моки + localStorage |
| History | `/history` | Моки + localStorage |
| MiniApp | `/mini-app/:id` | Моки (заглушка) |
| Admin | `/admin` | Моки + RLS-проверка ролей |
| Index | `/` | Редирект на /splash |
| NotFound | `*` | Статика |

Скриншоты были сделаны для всех ключевых экранов.

### 3. Навигация
- BottomNav: 3 таба (Лента, Чат, Сервисы)
- Точки входа: `/splash` → `/feed`
- Chat открывается как модальное окно (full-screen)
- Services, History, Settings — полноэкранные модалки с кнопкой X

### 4. Реализованная функциональность
**Работает полностью:**
- Авторизация (email/password через Supabase Auth + Zod-валидация)
- AI-чат со стриминговыми ответами (через Gemini 3 Flash)
- 9 специализированных AI-ассистентов с уникальными персонами
- Персистентные топики и сообщения в БД
- Анонимный режим чата (session_id)
- TikTok-style вертикальная лента
- Тёмная + светлая тема + Auto-режим
- Мульти-тенантная цветовая схема
- RLS-политики для topics, topic_messages, profiles
- Аналитика событий (analytics_events)
- Эскалация к эксперту (карточка после 5 сообщений)

### 5. Мок-данные vs реальная логика
**На моках (захардкожено в mockData.ts):**
- Все 15 карточек ленты (feedItems)
- Все эксперты (experts) — 9 человек по 4 сервисам
- Профиль пользователя (userProfile) — "Денис Чаннов"
- Мини-приложения (miniApps) — 4 заглушки
- История консультаций — моковые Booking в localStorage
- Статистика активности (12 консультаций, 2340 руб. сэкономлено)
- Промо-карточки (Премиум, Реферал)
- Quick Actions (Сканер, Оплата, Кэшбэк, Бонусы) — только тосты

**Подключено к реальному бэкенду:**
- Auth (signup/signin/signout)
- topics + topic_messages (CRUD)
- public_tenant_info (чтение тенантов)
- profiles (CRUD по user_id)
- analytics_events (вставка событий)
- user_roles (проверка admin-доступа)
- 4 Edge Functions: chat, lisa-stylist, colortype-analyzer, virtual-tryon

### 6. Дизайн-система
- Glassmorphism-стиль с backdrop-blur
- 12 категорийных цветов
- Шрифт: системный (Inter через Tailwind)
- Компоненты: полный shadcn/ui кит (50+ компонентов)
- Адаптивность: mobile-first, нет десктоп-версии

### 7. Технический стек
- React 18 + TypeScript + Vite
- Tailwind CSS + shadcn/ui + Framer Motion
- Supabase (Auth, PostgreSQL, Edge Functions)
- TanStack React Query
- React Router DOM v6
- Zod (валидация), date-fns (даты), Recharts (графики)

### 8. Известные ограничения и баги
- Нет RLS-policy на DELETE для topic_messages (очистка не работает)
- useVoiceRecorder — заглушка (только console.log)
- Бронирования сохраняются в localStorage, не в БД
- Нет экрана "Мои чаты" (список топиков)
- Нет пагинации сообщений (грузятся все)
- ProfileHeader использует хардкод из mockData
- Видеозвонки, переносы записей — toast-заглушки
- Мини-приложения — лендинги без функционала
- Уведомления — только toast-заглушки
- Подписка/платежи — не реализованы
- Поиск — отсутствует
- Нет CSS-transition при смене темы

## Технические детали

Файл будет создан как `PRODUCT_SCOPE.md` в корне проекта. Документ написан на русском языке, в формате Markdown. Скриншоты будут описаны текстом (вставка реальных изображений в .md невозможна без хостинга).

